<?php

// Generated by Haxe 3.3.0
class ufront_web_session_InlineSessionMiddleware implements ufront_app_UFMiddleware{
	public function __construct() { if(!php_Boot::$skip_constructor) {
		$GLOBALS['%s']->push("ufront.web.session.InlineSessionMiddleware::new");
		$__hx__spos = $GLOBALS['%s']->length;
		$GLOBALS['%s']->pop();
	}}
	public function requestIn($ctx) {
		$GLOBALS['%s']->push("ufront.web.session.InlineSessionMiddleware::requestIn");
		$__hx__spos = $GLOBALS['%s']->length;
		$tmp = null;
		$tmp1 = !ufront_web_session_InlineSessionMiddleware::$alwaysStart;
		if($tmp1) {
			$tmp2 = $ctx->session->get_id();
			if($tmp2 !== null) {
				$tmp3 = $ctx->session->get_id();
				$tmp = $tmp3 !== "";
			} else {
				$tmp = false;
			}
		} else {
			$tmp = true;
		}
		if($tmp) {
			$tmp2 = $ctx->session->init();
			$GLOBALS['%s']->pop();
			return $tmp2;
		} else {
			$tmp2 = ufront_core_SurpriseTools::success();
			$GLOBALS['%s']->pop();
			return $tmp2;
		}
		$GLOBALS['%s']->pop();
	}
	public function responseOut($ctx) {
		$GLOBALS['%s']->push("ufront.web.session.InlineSessionMiddleware::responseOut");
		$__hx__spos = $GLOBALS['%s']->length;
		$tmp = null;
		if($ctx->session !== null) {
			$tmp = $ctx->session->isReady();
		} else {
			$tmp = false;
		}
		if($tmp) {
			$tmp2 = $ctx->session->commit();
			$GLOBALS['%s']->pop();
			return $tmp2;
		} else {
			$tmp2 = ufront_core_SurpriseTools::success();
			$GLOBALS['%s']->pop();
			return $tmp2;
		}
		$GLOBALS['%s']->pop();
	}
	static $alwaysStart = false;
	function __toString() { return 'ufront.web.session.InlineSessionMiddleware'; }
}
